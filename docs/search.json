[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Weikersheim, Residenzschloss",
    "section": "",
    "text": "Katalog zur Ausstellung: Der Große Saal (Rittersaal)\nEin Katalog mit Kunstwerken aus der CbDD-Sammlung. Textteil: 6e73f774-4b7f-4e37-937b-e11cc35c5bc8\nDer Große Saal (Rittersaal) [Raum]\n This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivs 4.0 International License.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Katalog zur Ausstellung: Der Große Saal (Rittersaal)</span>"
    ]
  },
  {
    "objectID": "section.html",
    "href": "section.html",
    "title": "Die Saaldecke der Renaissance von Balthasar Katzenberger",
    "section": "",
    "text": "Code\nfrom datetime import datetime\nimport sys\nimport time\nfrom SPARQLWrapper import SPARQLWrapper, JSON\nimport requests\nfrom PIL import Image\nimport html\n\nendpoint_url = \"https://computational-publishing-service.wikibase.cloud/query/sparql\"\n\nquery_txt = \"\"\"PREFIX cps: &lt;https://computational-publishing-service.wikibase.cloud/entity/&gt;\nPREFIX cpss: &lt;https://computational-publishing-service.wikibase.cloud/entity/statement/&gt;\nPREFIX cpsv: &lt;https://computational-publishing-service.wikibase.cloud/value/&gt;\nPREFIX cpspt: &lt;https://computational-publishing-service.wikibase.cloud/prop/direct/&gt;\nPREFIX cpsp: &lt;https://computational-publishing-service.wikibase.cloud/prop/&gt;\nPREFIX cpsps: &lt;https://computational-publishing-service.wikibase.cloud/prop/statement/&gt;\nPREFIX cpspq: &lt;https://computational-publishing-service.wikibase.cloud/prop/qualifier/&gt;\n\n\nSELECT ?textItem ?kuratorLabel ?textUrl\nWHERE\n{\n  &lt;placeholder&gt;\n  ?textItem cpsp:P46 ?kuratorStatement. \n  ?kuratorStatement cpsps:P46 ?kuratorItem. \n  ?kuratorItem rdfs:label ?kuratorLabel.\n  ?textItem cpsp:P57 ?urlstatement. \n  ?urlstatement cpsps:P57 ?textUrl. \n}\"\"\"\n\nquery_img =\"\"\"PREFIX cps: &lt;https://computational-publishing-service.wikibase.cloud/entity/&gt;\nPREFIX cpss: &lt;https://computational-publishing-service.wikibase.cloud/entity/statement/&gt;\nPREFIX cpsv: &lt;https://computational-publishing-service.wikibase.cloud/value/&gt;\nPREFIX cpspt: &lt;https://computational-publishing-service.wikibase.cloud/prop/direct/&gt;\nPREFIX cpsp: &lt;https://computational-publishing-service.wikibase.cloud/prop/&gt;\nPREFIX cpsps: &lt;https://computational-publishing-service.wikibase.cloud/prop/statement/&gt;\nPREFIX cpspq: &lt;https://computational-publishing-service.wikibase.cloud/prop/qualifier/&gt;\n\nSELECT DISTINCT ?itemLabel ?itemDescr ?imgItem ?imgUrl ?publishDate\nWHERE\n{\n  ?imgItem cpsp:P107 ?urlStatement. \n  ?urlStatement cpsps:P107 ?imgUrl. \n  ?imgItem cpsp:P60 ?dateStatement. \n  ?dateStatement cpsps:P60 ?publishDate. \n  ?imgItem cpsp:P6 ?partOfStatement.\n  ?partOfStatement cpsps:P6 ?partOfItem.\n  &lt;placeholder&gt; \n\n  FILTER (datatype(?publishDate) = xsd:edtf)\n  \n  SERVICE wikibase:label {\n      bd:serviceParam wikibase:language \"en,de\".\n      ?imgItem rdfs:label ?itemLabel.\n      ?imgItem schema:description ?itemDescr.\n    }\n}\"\"\"\nquery_graph = \"\"\"PREFIX cps: &lt;https://computational-publishing-service.wikibase.cloud/entity/&gt;\nPREFIX cpss: &lt;https://computational-publishing-service.wikibase.cloud/entity/statement/&gt;\nPREFIX cpsv: &lt;https://computational-publishing-service.wikibase.cloud/value/&gt;\nPREFIX cpspt: &lt;https://computational-publishing-service.wikibase.cloud/prop/direct/&gt;\nPREFIX cpsp: &lt;https://computational-publishing-service.wikibase.cloud/prop/&gt;\nPREFIX cpsps: &lt;https://computational-publishing-service.wikibase.cloud/prop/statement/&gt;\nPREFIX cpspq: &lt;https://computational-publishing-service.wikibase.cloud/prop/qualifier/&gt;\n\nSELECT ?x ?y\nWHERE\n{\n  ?a cpsp:P2 ?c.\n  ?c cpsps:P2 ?d.\n  ?a rdfs:label ?x.\n  ?d rdfs:label ?y.\n\n}LIMIT 1\"\"\"\n\nquery_graph2 = \"\"\"\nSELECT ?a ?b ?c\nWHERE\n{\n  ?a rdfs:label ?c\n}LIMIT 100\"\"\"\n\n\ndef run_query(endpoint_url, query):\n    user_agent = \"WDQS-example Python/%s.%s\" % (sys.version_info[0], sys.version_info[1])\n    # TODO adjust user agent; see https://w.wiki/CX6\n    sparql = SPARQLWrapper(endpoint_url, agent=user_agent)\n    sparql.setQuery(query)\n    sparql.setMethod(\"POST\") #this NEEDS to be added to get results (not included in the wikibase python example code)\n    sparql.setReturnFormat(JSON)\n    return sparql.query().convert()\n\ndef get_text(textitem_id):\n    q = \"\"\n    if textitem_id:\n        q = query_txt.replace(\"&lt;placeholder&gt;\", \"cps:\"+textitem_id+\" cpsp:P46 ?kuratorStatement.\")\n    else:\n        q = query_txt.replace(\"&lt;placeholder&gt;\",\"\")\n\n    results_txt = run_query(endpoint_url, q)\n    for item in results_txt[\"results\"][\"bindings\"]:\n        # print(item)\n        print('Wikibase link: ' + '[' + item['textItem']['value'] + ']' + '(' + item['textItem']['value'] + ')' + '\\n')\n        print('Kurator: ' + item['kuratorLabel']['value'] + '\\n')\n        headers = {'User-Agent': 'Ex_Books_conference_bot/0.0 (https://github.com/SimonXIX/Experimental_Books_workshop; ad7588@coventry.ac.uk)'}\n        r = requests.get(item['textUrl']['value'], headers=headers, stream=True)\n        text = str(r.content)\n        text = text.replace(\"ä\",\"&auml;\")\n        text = text.replace(\"Ä\",\"&Auml;\")\n        text = text.replace(\"ö\",\"&ouml;\")\n        text = text.replace(\"Ö\",\"&Ouml;\")\n        text = text.replace(\"ü\",\"&uuml;\")\n        text = text.replace(\"Ü\",\"&Uuml;\")\n        text = text.replace(\"ß\",\"&szlig;\")\n        text = text.replace('\\\\n',\"&lt;br&gt;\")\n        text = str(text)\n        text = text.removeprefix(\"b'&lt;!DOCTYPE html&gt;\").removesuffix(\"'\")\n        print(text)\n\ndef get_delay(date):\n    try:\n        date = datetime.datetime.strptime(date, '%a, %d %b %Y %H:%M:%S GMT')\n        timeout = int((date - datetime.datetime.now()).total_seconds())\n    except ValueError:\n        timeout = int(date)\n    return timeout\n\ndef fetch_image_by_url(url, headers):\n    r = requests.get(url, headers=headers, stream=True)\n    if r.status_code == 200:\n        im = Image.open(r.raw)\n        return im\n    if r.status_code == 500:\n        return None\n    if r.status_code == 403:\n        return None\n    if r.status_code == 429:\n        timeout = get_delay(r.headers['retry-after'])\n        print('Timeout {} m {} s'.format(timeout // 60, timeout % 60))\n        time.sleep(timeout)\n        fetch_image_by_url(url, headers)\n\ndef get_img(partOfItem_id):\n    q = \"\"\n    if partOfItem_id:\n        q = query_img.replace(\"&lt;placeholder&gt;\", \"?partOfStatement cpsps:P6 cps:\"+partOfItem_id+\".\")\n    else:\n        q = query_img.replace(\"&lt;placeholder&gt;\",\"\")\n    results_img = run_query(endpoint_url, q)\n    for item in results_img[\"results\"][\"bindings\"]:    \n      #print(item)\n      print('Wikibase link: ' + '[' + item['imgItem']['value'] + ']' + '(' + item['imgItem']['value'] + ')' + '\\n')\n      print('Title: ' + item['itemLabel']['value'] + '\\n')\n      print('Year: ' + item['publishDate']['value'] + '\\n')\n      print('Description: ' + html.unescape(item['itemDescr']['value']) + '\\n')\n\n      # get image from image URL and display resized version\n      image_url=item['imgUrl']['value']\n      headers = {'User-Agent': 'Ex_Books_conference_bot/0.0 (https://github.com/SimonXIX/Experimental_Books_workshop; ad7588@coventry.ac.uk)'}\n      im = fetch_image_by_url(image_url, headers)\n      im.thumbnail((500, 500), Image.Resampling.LANCZOS)\n      display(im)\n      print('\\n\\n')\n\ndef get_graph():\n    import VizKG.visualize as vkg\n    results_graph1 = run_query(endpoint_url, query_graph)\n    print(results_graph1)\n    print('---')\n    results_graph2 = run_query(endpoint_url, query_graph2)\n    print(results_graph2)\n\n    chart = vkg(sparql_query=query_graph2, sparql_service_url=endpoint_url, chart='wordcloud')\n    chart.plot()\n\nHow to use your own text for processing\n\nAdd a new Text item to the wikibase. link to wikibase new item the item should contain the following statements:\n\n\nP57 (external link): link to the html file containing the new text\nP46 (kurator): Item of the curator. you may use an existing item like Q210 (Ulrike seeger) for test purposes\nP53 (license): Item of a license for the text. e.g Q203 (CC BY-NC-ND 4.0 DEED )\nP6 (is part of): set value to Q218 (Schlossanlage Weikersheim)\n\n\ncheck if your new text item occurs in the list of selected text items: Link to wikibase query service\nset parameter of get_text() to the id of your new text item e.g.: get_text(“Q209”)\n\n\nCode\nget_text(\"Q229\")\n\nWikibase link: https://computational-publishing-service.wikibase.cloud/entity/Q229\nKurator: Seeger, Ulrike\nb’&lt;!DOCTYPE html&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDie Saaldecke der Renaissance von Balthasar Katzenberger\n\n\n\nVertragsbedingungen\n\n\n\n Der Vertrag zu den 69 Deckengemälden des Großen Saals zwischen Graf Wolfgang und Balthasar Katzenberger hat sich erhalten.[1] Darin wurde am 22. September 1601 festgelegt, dass der Maler Balthasar Katzenberger aus Würzburg „Ihren gnaden [Graf Wolfgang] die deckh im Neuen Saal mit Wasserfarb auff Tuech von allerlej Jagden, Waydtwerkh und andern was Ire g. Ime jedesmals fürgeben und beuehlen laßen, aufs schönst Säuberst, Künstlichstelichen und frech aussehendt mallen soll, alle Simbs der gannzen Deckh sowoll auch neben herrumb das Simbs alles mit brauner nus oder sonsten ein Dunckhel holz färb, wie es Iren gnaden gefellig anstreichen“.[2]\n\n\n\n Graf Wolfgang scheint sowohl das Thema der Jagd vorgegeben als auch die zugehörigen druckgraphischen Vorlagen zur Verfügung gestellt zu haben. Den Passus „allerlej Jagden, Waydtwerkh und andern was Ire g. Ime jedesmals fürgeben und beuehlen laßen“ hat man wahrscheinlich dahingehend zu deuten, dass der Auftraggeber in absehbarer Zeit noch weitere Vorlagen liefern könnte. Die zur Anwendung gelangte Technik „mit Wasserfarb auff Tuech“ scheint nur die zweite Wahl gewesen zu sein. In den Vertrag wurde der Zusatz aufgenommen, dass, sollte Graf Wolfgang sich doch noch für Ölfarben entscheiden, er anstatt der vereinbarten 195 Gulden 260 Gulden zu zahlen habe, jeweils zuzüglich der täglichen Verpflegung:\n\n\n\n „Da [= Falls] es aber Ihren Gnaden gefellig wer solche deckh mit öll färb zuverferttigen soll Ihme für seine belohnung gegeben werden, Zway hundert und Sechzig gülden. Die Cost und Suppen wie gemelt“.[3]\n\n\n\n Laut Restaurierungsbericht malte Katzenberger in Leimfarben auf grober, hellgelb grundierter Leinwand.[4] Erst Christian Thalwitzer, der die Gemälde 1710/11 überarbeitete, verstärkte ihre Leuchtkraft mit einer roten Grundierung und Ölfarben, was ebenfalls die Restaurierung der Jahre 1982–1989 erbrachte. Eines der quadratischen Gemälde (Q1) überliefert auf der Rückseite die originale Maltechnik. Katzenberger hatte das Gemälde angelegt und in der rechten Bildhälfte nahezu fertiggestellt, als sich für die in der linken Bildhälfte angelegte Figur eine Änderung ergab. Da Leimfarben schlecht decken, verzichtete er auf eine Übermalung und drehte die Leinwand kurzerhand um.[5]\n\n\n\n Die Gemälde entstanden in der Werkstatt, wobei für die achteckigen Gemälde mit einer Höhe von 3,65 Metern ein Gerüst gezimmert werden musste. Da der Vertrag zu Beginn der dunklen Jahreszeit Ende September abgeschlossen wurde, legte Graf Wolfgang vorsorglich fest, dass Katzenberger nur bei Tageslicht malen dürfe: „In Summa solche Deckh wie gemelt [= wie oben vereinbart] er selbsten alles bej tag und nit bej nacht aufs Künstlichst und schönst machen und verferttigen“. Der Auftraggeber stellte die Leinwand, die Farben, Gold und Steinöl für die Gesimse. Gemalt hat Katzenberger die Bilder unter Aufsicht des Grafen in Weikersheim, da sein Lohn neben den 195 Gulden aus morgendlicher und abendlicher Verpflegung mit Brot und Suppe ohne Fleisch bestand.\n\n\n\n Katzenberger benötigte für die Arbeit, die er ganz allein, also ohne Kompagnon, nur mit Malergehilfen leistete, dreizehn Monate. Die Fertigstellung quittierte er am 22. November 1602.[6] In die zahlreichen Künstlersignaturen von Graf Wolfgangs Renaissanceausstattung reihte er sich auf dem Achteck-Gemälde Nr. 13 ein, das sich knapp östlich der Mitte der Decke befindet. Sinnfällig nutzte er das Thema der Wildkatzenjagd für ein Selbstporträt mit Pinsel, Malstock und Palette. Rechts unten notierte er in schwarzer Schrift: „Balthasar Katzenberger vo[n] Wurtzburg maler hat diese gantze Decken in ⋅ 13 ⋅ monat alleins gemalet 1602“.[7] Rechnet man sechs Arbeitstage pro Woche, so entfallen fünf Tage auf ein Bild, wobei freilich die 12 Blumenbilder deutlich weniger Zeit in Anspruch nahmen als die 19 großen Achteckbilder.\n\n\n\n Balthasar Katzenberger schuf für Schloss Weikersheim seine umfangreichsten erhaltenen Werke. Über weitere Anhaltspunkte zu seinem Oeuvre und seinem Lebensweg unterrichtet der Eintrag im Allgemeinen Künstlerlexikon.[8]\n\n\n\n\n\n\n\nHow to select images for processing\nImages are selected via the sparql query. The method get_img() is capable of using a wikibase item id as parameter to select images with the property P6 (is part of) linking to the given item id.\n\nselect a valid location id from the query result: Link to wikibase query service\nset parameter of get_img() to the id of your selected location item e.g.: get_img(“Q217”)\n\n\nCode\nget_img(\"Q229\")\n\nWikibase link: https://computational-publishing-service.wikibase.cloud/entity/Q230\nTitle: Ceiling Decoration of the Knights’ Hall – Eastern Part of the Ceiling\nYear: 2018\nDescription: Balthasar Kazenberger, painter, 22.09.1601/22.11.1602 - Jan van der Straet, painter - Christian Thalwitzer, restorer, 1710/1711\n\n\n\nCode\nget_graph()\n\n\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\nCell In[13], line 1\n----&gt; 1 get_graph()\n\nCell In[9], line 166, in get_graph()\n    165 def get_graph():\n--&gt; 166     import VizKG.visualize as vkg\n    167     results_graph1 = run_query(endpoint_url, query_graph)\n    168     print(results_graph1)\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/__init__.py:1\n----&gt; 1 from .visualize import *\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/visualize.py:3\n      1 import sys\n      2 import random\n----&gt; 3 from .utils import set_chart, set_dataframe, chartdict\n      4 from .charts import Chart\n      5 class VizKG:\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/utils/__init__.py:1\n----&gt; 1 from .util import *\n      2 from .chartdict import chartdict\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/utils/util.py:9\n      6 from difflib import SequenceMatcher\n      7 import ssl\n----&gt; 9 from .chartdict import chartdict as chart_dictionary\n     11 def set_chart(chart_input):\n     12     \"\"\"\n     13     Setter of chart based on chart input\n     14 \n   (...)\n     17     :return: (str) chart: The available chart   \n     18     \"\"\"\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/utils/chartdict.py:1\n----&gt; 1 from VizKG.charts import *\n      2 \"\"\"\n      3 Dictionary of visualization charts \n      4 \"\"\"\n      5 chartdict = {\n      6     'imagegrid': ImageGrid,\n      7     'timeline': Timeline,\n   (...)\n     29     'radarchart': RadarChart\n     30 }\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/charts/__init__.py:7\n      5 from .graph import Graph\n      6 from .map import Map\n----&gt; 7 from .table import Table\n      8 from .imagegrid import ImageGrid\n      9 from .dimensions import Dimensions\n\nFile ~/.python/current/lib/python3.10/site-packages/VizKG/charts/table.py:2\n      1 from .chart import Chart\n----&gt; 2 import plotly.figure_factory as ff\n      3 from IPython.display import display\n      4 import pandas as pd\n\nFile ~/.local/lib/python3.10/site-packages/plotly/figure_factory/__init__.py:32\n     30 if optional_imports.get_module(\"pandas\") is not None:\n     31     from plotly.figure_factory._county_choropleth import create_choropleth\n---&gt; 32     from plotly.figure_factory._hexbin_mapbox import create_hexbin_mapbox\n     33 else:\n     35     def create_choropleth(*args, **kwargs):\n\nFile ~/.local/lib/python3.10/site-packages/plotly/figure_factory/_hexbin_mapbox.py:2\n      1 from plotly.express._core import build_dataframe\n----&gt; 2 from plotly.express._doc import make_docstring\n      3 from plotly.express._chart_types import choropleth_mapbox, scatter_mapbox\n      4 import numpy as np\n\nFile ~/.local/lib/python3.10/site-packages/plotly/express/__init__.py:15\n      9 if pd is None:\n     10     raise ImportError(\n     11         \"\"\"\\\n     12 Plotly express requires pandas to be installed.\"\"\"\n     13     )\n---&gt; 15 from ._imshow import imshow\n     16 from ._chart_types import (  # noqa: F401\n     17     scatter,\n     18     scatter_3d,\n   (...)\n     49     density_mapbox,\n     50 )\n     53 from ._core import (  # noqa: F401\n     54     set_mapbox_access_token,\n     55     defaults,\n     56     get_trendline_results,\n     57     NO_COLOR,\n     58 )\n\nFile ~/.local/lib/python3.10/site-packages/plotly/express/_imshow.py:4\n      2 from _plotly_utils.basevalidators import ColorscaleValidator\n      3 from ._core import apply_default_cascade, init_figure, configure_animation_controls\n----&gt; 4 from .imshow_utils import rescale_intensity, _integer_ranges, _integer_types\n      5 import pandas as pd\n      6 import numpy as np\n\nFile ~/.local/lib/python3.10/site-packages/plotly/express/imshow_utils.py:24\n      9 _integer_types = (\n     10     np.byte,\n     11     np.ubyte,  # 8 bits\n   (...)\n     19     np.ulonglong,\n     20 )  # 64 bits\n     21 _integer_ranges = {t: (np.iinfo(t).min, np.iinfo(t).max) for t in _integer_types}\n     22 dtype_range = {\n     23     np.bool_: (False, True),\n---&gt; 24     np.bool8: (False, True),\n     25     np.float16: (-1, 1),\n     26     np.float32: (-1, 1),\n     27     np.float64: (-1, 1),\n     28 }\n     29 dtype_range.update(_integer_ranges)\n     32 DTYPE_RANGE = dtype_range.copy()\n\nFile ~/.python/current/lib/python3.10/site-packages/numpy/__init__.py:410, in __getattr__(attr)\n    407     import numpy.char as char\n    408     return char.chararray\n--&gt; 410 raise AttributeError(\"module {!r} has no attribute \"\n    411                      \"{!r}\".format(__name__, attr))\n\nAttributeError: module 'numpy' has no attribute 'bool8'",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Die Saaldecke der Renaissance von Balthasar Katzenberger</span>"
    ]
  }
]